# Core tiles

- [x] `.direction` getter/setter

## Core.detect()

- [ ] Note that `detect()` must defer detection. It will collect multiple nodes and after a 7ms timeout it should detect these nodes and clear up again the detection list. After everything is detected (e.g. things are repositioned/resized/removed), rearrange (e.g. for mutating the container's size and groups size).

Tiles:

- [ ] Contributes a newly-added DOM tile, or detects moving X/Y, resizing and group transfer (look at parent).
- [ ] ... or, given a removed DOM tile, remove tile from state (both SimpleGroup and CoreGroup's tiles), remove parent group if empty and rearrange groups.
  - *This is usually called on React.js effect cleanup.*
- [ ] Attach mouse down/click/touch down/touch end handlers for click, check and drag-n-drop events
  - [ ] Drag-n-drop only occurs if `Core.dragEnabled=true`
  - [ ] (un-)checking tiles only occurs if `Core.checkEnabled=true`

Groups:

- [ ] Contributes a newly-added DOM group, or detects label change.
- [ ] ... or, given a removed DOM group, remove group from state and rearrange groups.
  - *This is usually called on React.js effect cleanup.*
- [ ] Group indices are based in DOM order among sibling `TileGroup`s (e.g. disregard `TileDND`).

## Core.rearrange()

- [x] Done

## Core._rearrange_now()

Implementation should be split into two layout classes: HorizontalLayout and VerticalLayout, which are created as throwaway objects.

- [ ] Layout.rearrangeGroup(): Hide overflow of the groupTiles div while tweening off view.
- [ ] Re-assigns group label's `height` style
- [ ] Trigger bulk change event if the case

## Group label

- [ ] Editing

## Tile drag-n-drop

Trick to use: Draggable needs to drag the tileDND element, not the tile itself. For this, simply dispatch virtual `mousedown` and `touchdown` (with the same device ID as the tile's touch) events with corresponding coordinates and touch collections (touches/targetTouches/changedTouches).

- [ ] Make tile invisible while dragging (and tileDND visible)
- [ ] Touch start
  - [ ] Trigger click
  - [ ] Trigger check
  - [ ] Trigger drag-n-drop (long-held)
    - [ ] Trigger events
- [ ] Mouse down
  - [ ] Trigger click
  - [ ] Trigger check
  - [ ] Trigger drag-n-drop (after short-delta)
    - [ ] Trigger events

More:

- [ ] While dragging a tile, enable overflow clipping at the groupTiles div.
  - [ ] When drag ends, still leave overflow clipping active for around 750 ms.
- [ ] When a group gets empty after drag end, remove it.

## Group drag-n-drop

Group drag-n-drop mimmicks tiles a bit in how the Draggable instance is created, with some subtle differences.

- [ ] Label > touch start
  - [ ] Edit
  - [ ] Trigger drag-n-drop (long-held)
    - [ ] Trigger events
- [ ] Label > mouse down
  - [ ] Edit
  - [ ] Trigger drag-n-drop (after short-delta)
    - [ ] Trigger events